FROM buglord/centos7-base:latest

# Install X11 and other required packages
RUN yum install -y \
    xorg-x11-xauth \
    xorg-x11-utils \
    mesa-libGL \
    mesa-dri-drivers \
    mesa-libGLU \
    libX11 \
    libXext \
    libXrender \
    libXtst \
    fuse \
    fuse-libs \
    xdg-utils \
    firefox && \
    yum clean all

# Download and set up cursor.app
RUN wget -O /tmp/cursor.app https://downloader.cursor.sh/linux && \
    chmod +x /tmp/cursor.app && \
    /tmp/cursor.app --appimage-extract && \
    mv squashfs-root /usr/local/cursor && \
    rm /tmp/cursor.app

# Prepare directories
RUN mkdir -p /run/dbus

ENV APPDIR=/usr/local/cursor

# Set environment variable for X11 display
ENV DISPLAY=:0

COPY cursor.sh /bin/cursor.sh
RUN chmod +x /bin/cursor.sh

# Start the application
CMD ["cursor.sh"]
